$puts "Loading wip..."
x := use "modules/testmod" or fail "Failed to load testmod"
$puts "Fully loaded: $(x.rand)"
$puts "Loading wip again..."
y := use "modules/testmod" or fail "Failed to load testmod"
$puts "Fully loaded: $(y.rand)"
fail "Module idempotency failed" unless x.rand == y.rand

fail "Module string equality check failed '$(x.str)' != 'string'" unless x.str == "string"

"blop" | (x.bloop) | $puts

use "modules/testothermod" or fail "Failed to use testothermod"

$puts "$from_othermod"
$puts "Call: $(othermod_foo(5))"

emp := use "modules/emptymod" or fail "Failed to use emptymod"
$puts "$emp"
